<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard - Products</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="sidebar.css">
  <link rel="stylesheet" href="products.css">
  <link rel="stylesheet" href="loading.css">
  <link rel="stylesheet" href="pagination.css">
  <link rel="stylesheet" href="navigation.css">
  <link rel="stylesheet" href="validation.css">
  <link rel="stylesheet" href="cache-notice.css">
</head>
<body>

<!-- Sidebar Navigation - Loaded from sidebar.html -->
<div id="sidebar-container"></div>
<button id="mobile-menu-toggle" class="mobile-menu-toggle" aria-label="Toggle menu">â˜°</button>

<header class="topbar">
  <div class="container">
    <h1>ğŸ§© Sáº£n pháº©m</h1>
    <div class="session-actions">
    <div id="session-info" class="session-info"></div>
      <button id="btn-logout" class="btn-logout hidden" type="button">ÄÄƒng xuáº¥t</button>
    </div>
  </div>
</header>

<!-- Cache Notice - Loaded from cache-notice.html -->
<div id="cache-notice-container" class="container"></div>

<main class="container">
  <section class="card" id="login-section">
    <h2>ÄÄƒng nháº­p quáº£n trá»‹</h2>
    <div class="grid">
      <div>
        <label>API KEY</label>
        <input id="api_key" type="text" placeholder="API KEY">
      </div>
      <div>
        <label>Email owner</label>
        <input id="email" type="email" placeholder="owner@shop.com">
      </div>
      <div>
        <label>Password owner</label>
        <input id="password" type="password" placeholder="password">
      </div>
    </div>
    <button id="btn-login">ÄÄƒng nháº­p</button>
  </section>

  <section class="card">
    <div class="card-header">
      <h2>Danh sÃ¡ch sáº£n pháº©m</h2>
      <div class="card-actions">
        <button id="btn-new" class="btn-secondary">+ ThÃªm sáº£n pháº©m</button>
      </div>
    </div>

    <div class="table-wrap">
      <table id="products-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Price</th>
            <th>Stock</th>
            <th>Availability</th>
            <th>Brand</th>
            <th>MPN</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr><td colspan="7" class="muted">ÄÄƒng nháº­p Ä‘á»ƒ táº£i dá»¯ liá»‡u...</td></tr>
        </tbody>
      </table>
      <div id="products-pagination"></div>
    </div>
  </section>
</main>

<div id="product-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 id="modal-title">ThÃªm sáº£n pháº©m</h3>
      <button id="btn-close" class="btn-close">Ã—</button>
    </div>

    <div class="grid">
      <div>
        <label>ID (mÃ£ sáº£n pháº©m) *</label>
        <input id="field-id" type="text">
      </div>
      <div>
        <label>Title *</label>
        <input id="field-title" type="text">
      </div>
      <div>
        <label>Description</label>
        <textarea id="field-description" rows="3"></textarea>
      </div>
      <div>
        <label>Availability</label>
        <input id="field-availability" type="text" placeholder="in stock">
      </div>
      <div>
        <label>Image link</label>
        <div class="image-input-group">
          <input id="field-image-link" type="text" placeholder="Nháº­p link áº£nh hoáº·c upload áº£nh">
          <button type="button" id="btn-upload-image" class="btn-upload">ğŸ“· Upload áº£nh</button>
          <input type="file" id="file-image-upload" accept="image/*" style="display: none;">
        </div>
        <a href="#" id="image-link-help" class="help-link">â„¹ï¸ HÆ°á»›ng dáº«n sá»­ dá»¥ng Image Link</a>
        <div id="image-preview" class="image-preview" style="display: none;">
          <img id="image-preview-img" src="" alt="Preview">
          <button type="button" id="btn-remove-image" class="btn-remove-image">âœ•</button>
        </div>
      </div>
      <div>
        <label>GiÃ¡ nháº­p (Import price)</label>
        <input id="field-import-price" type="number" step="0.01">
      </div>
      <div>
        <label>GiÃ¡ bÃ¡n Ä‘á» xuáº¥t (Price) *</label>
        <input id="field-price" type="number" step="0.01">
      </div>
      <div id="field-amount-in-stock-wrapper">
        <label>Amount in stock</label>
        <input id="field-amount-in-stock" type="number" step="1" min="0">
      </div>
      <div>
        <label>MPN</label>
        <input id="field-mpn" type="text">
      </div>
      <div>
        <label>Brand</label>
        <input id="field-brand" type="text">
      </div>
      <div>
        <label>Category</label>
        <div class="category-input-group">
          <select id="field-category-select">
            <option value="">-- Chá»n danh má»¥c --</option>
          </select>
          <span style="margin: 0 8px; color: #94a3b8;">hoáº·c</span>
          <input id="field-category-new" type="text" placeholder="Nháº­p tÃªn danh má»¥c má»›i">
        </div>
        <input type="hidden" id="field-category-id" value="">
      </div>
    </div>

    <!-- Product Detail Section - Full Width -->
    <div class="detail-section-full">
      <label>Product Detail (HTML)</label>
      <div class="detail-input-group">
        <textarea id="field-detail" rows="8" placeholder="Nháº­p HTML chi tiáº¿t sáº£n pháº©m..."></textarea>
        <div class="detail-actions">
          <button type="button" id="btn-save-detail" class="btn-save-detail">ğŸ’¾ LÆ°u Detail lÃªn GitHub</button>
          <button type="button" id="btn-load-detail" class="btn-load-detail" style="display: none;">ğŸ“¥ Load tá»« URL</button>
        </div>
      </div>
      <div class="detail-url-group">
        <label style="font-size: 12px; color: #64748b; margin-top: 8px;">Detail URL (tá»± Ä‘á»™ng Ä‘iá»n sau khi lÆ°u)</label>
        <input id="field-detail-url" type="text" placeholder="https://cdn.jsdelivr.net/gh/..." readonly style="background: #f8fafc;">
      </div>
      <div id="detail-status" class="detail-status" style="display: none;"></div>
    </div>

    <div class="modal-actions">
      <button id="btn-save" class="btn-primary">LÆ°u</button>
    </div>
  </div>
</div>

<!-- Image Link Help Modal -->
<div id="image-link-help-modal" class="modal">
  <div class="modal-content modal-help">
    <div class="modal-header">
      <h3>ğŸ“· HÆ°á»›ng dáº«n Image Link</h3>
      <button id="btn-close-help" class="btn-close">Ã—</button>
    </div>
    <div class="help-content">
      <div class="help-section">
        <h4>ğŸ¯ CÃ³ 2 cÃ¡ch Ä‘á»ƒ thÃªm áº£nh sáº£n pháº©m:</h4>
        <div class="help-option">
          <div class="help-option-title">1ï¸âƒ£ Nháº­p link áº£nh cÃ³ sáºµn</div>
          <p>Náº¿u báº¡n Ä‘Ã£ cÃ³ link áº£nh tá»« nguá»“n khÃ¡c (vÃ­ dá»¥: CDN, website khÃ¡c), chá»‰ cáº§n dÃ¡n link vÃ o Ã´ <strong>Image link</strong>.</p>
          <div class="help-example">
            <strong>VÃ­ dá»¥:</strong> <code>https://example.com/image.jpg</code>
          </div>
        </div>
        <div class="help-option">
          <div class="help-option-title">2ï¸âƒ£ Upload áº£nh lÃªn GitHub</div>
          <p>Báº¥m nÃºt <strong>ğŸ“· Upload áº£nh</strong> Ä‘á»ƒ táº£i áº£nh tá»« mÃ¡y tÃ­nh lÃªn GitHub. Link sáº½ tá»± Ä‘á»™ng Ä‘Æ°á»£c Ä‘iá»n vÃ o Ã´ Image link.</p>
          <div class="help-note">
            <strong>âš ï¸ LÆ°u Ã½:</strong> Äá»ƒ sá»­ dá»¥ng tÃ­nh nÄƒng upload, báº¡n cáº§n cáº¥u hÃ¬nh GitHub trong <strong>Settings</strong> trÆ°á»›c.
          </div>
        </div>
      </div>
      
      <div class="help-section">
        <h4>âš™ï¸ Cáº¥u hÃ¬nh GitHub trong Settings:</h4>
        <ol class="help-steps">
          <li>VÃ o menu <strong>Settings</strong> (CÃ i Ä‘áº·t)</li>
          <li>Äiá»n cÃ¡c thÃ´ng tin sau:
            <ul>
              <li><strong>GitHub Owner:</strong> TÃªn tÃ i khoáº£n GitHub cá»§a báº¡n</li>
              <li><strong>GitHub Repo:</strong> TÃªn repository Ä‘á»ƒ lÆ°u áº£nh (vÃ­ dá»¥: <code>product-images</code>)</li>
              <li><strong>GitHub Branch:</strong> NhÃ¡nh repository (thÆ°á»ng lÃ  <code>main</code>)</li>
              <li><strong>GitHub Token:</strong> Personal Access Token tá»« GitHub</li>
            </ul>
          </li>
          <li>Báº¥m <strong>LÆ°u cÃ i Ä‘áº·t</strong></li>
        </ol>
      </div>
      
      <div class="help-section">
        <h4>ğŸ”‘ Táº¡o GitHub Token:</h4>
        <ol class="help-steps">
          <li>VÃ o <a href="https://github.com/settings/tokens" target="_blank">GitHub Settings â†’ Developer settings â†’ Personal access tokens â†’ Tokens (classic)</a></li>
          <li>Báº¥m <strong>Generate new token (classic)</strong></li>
          <li>Chá»n cÃ¡c quyá»n (scopes):
            <ul>
              <li><strong>âœ… repo</strong> - Full control of private repositories (hoáº·c <strong>public_repo</strong> náº¿u dÃ¹ng public repo)</li>
            </ul>
          </li>
          <li>Báº¥m <strong>Generate token</strong> vÃ  copy token</li>
          <li>DÃ¡n token vÃ o Ã´ <strong>GitHub Token</strong> trong Settings</li>
        </ol>
      </div>
      
      <div class="help-section">
        <h4>ğŸ’¡ Máº¹o:</h4>
        <ul class="help-tips">
          <li>KÃ­ch thÆ°á»›c áº£nh tá»‘i Ä‘a: <strong>5MB</strong></li>
          <li>Äá»‹nh dáº¡ng há»— trá»£: JPG, PNG, GIF, WebP</li>
          <li>Sau khi upload, áº£nh sáº½ Ä‘Æ°á»£c lÆ°u trÃªn GitHub vÃ  hiá»ƒn thá»‹ qua CDN jsDelivr</li>
          <li>Báº¡n cÃ³ thá»ƒ xem preview áº£nh ngay sau khi nháº­p link hoáº·c upload</li>
        </ul>
      </div>
    </div>
    <div class="modal-actions">
      <button id="btn-close-help-footer" class="btn-primary">ÄÃ£ hiá»ƒu</button>
    </div>
  </div>
</div>

<script src="loading.js"></script>
<script src="auth.js"></script>
<script src="cache.js"></script>
<script src="common.js"></script>
<script src="worker-api.js"></script>
<script src="pagination.js"></script>
<script src="validation.js"></script>
<script>
  // Load sidebar HTML from sidebar.html
  (function() {
    fetch('sidebar.html')
      .then(response => {
        if (!response.ok) {
          throw new Error('Failed to load sidebar');
        }
        return response.text();
      })
      .then(html => {
        document.getElementById('sidebar-container').innerHTML = html;
        // Initialize sidebar after loading
        const script = document.createElement('script');
        script.src = 'sidebar.js';
        script.onload = function() {
          console.log('âœ… Sidebar loaded and initialized');
        };
        document.body.appendChild(script);
      })
      .catch(err => {
        console.error('âŒ Error loading sidebar:', err);
        // Fallback: show error message
        document.getElementById('sidebar-container').innerHTML = 
          '<div style="padding: 20px; color: #ef4444;">Error loading sidebar</div>';
      });
  })();

  // Load cache notice HTML from cache-notice.html
  (function() {
    fetch('cache-notice.html')
      .then(response => {
        if (!response.ok) {
          throw new Error('Failed to load cache notice');
        }
        return response.text();
      })
      .then(html => {
        document.getElementById('cache-notice-container').innerHTML = html;
        // Initialize cache notice after loading
        const script = document.createElement('script');
        script.src = 'cache-notice.js';
        script.onload = function() {
          console.log('âœ… Cache notice loaded and initialized');
        };
        document.body.appendChild(script);
      })
      .catch(err => {
        console.error('âŒ Error loading cache notice:', err);
        // Don't show error, just log it (cache notice is not critical)
      });
  })();
</script>
<script src="products.js"></script>
</body>
</html>
